{% extends 'layout.html' %}
{% block content %}
    <!--Content -->
    <section id="service" class="section-padding wow fadeIn delay-05s">
      <div class="container">
        <div class="alert alert-danger alert-dismissible" role="alert">
            <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <span>Njoftim!!! Per shkak se personat(Pronar&euml;/Zyrtar&euml;) nuk kan&euml; num&euml;r identifikimi rezultati shfaqet nga emri i njejt&euml; i atij personi.</span>
        </div>
        <div class="row">
          <h3 style="text-align:center;">Rezultatet rreth {{person}}</h3>
          <div class="col-xs-12 text-left">
              <span>T&euml;
                  {%if count < 10%}
                      shfaqura {{count}} dokumente
                  {%else%}
                      shfaqura <span id="tableLength"></span> nga {{count}} dokumente
                  {%endif%}
              </span>
          </div>
          <table class="table table-striped table-bordered" id="searchTable">
              <thead>
                  <tr>
                      <th>Emri i Biznesit</th>
                      <th>Statusi i Biznesit</th>
                      <th>Komuna</th>
                      <th>Pronar&euml;t</th>
                      <th>T&euml; autorizuar&euml;t</th>
                  </tr>
              </thead>
              <tbody>
                  {%if count != 0%}
                      {% for doc in profile_data %}
                      <tr>
                          <td><a href="{{doc['arbkUrl']}}">{{doc['name']}}</a></td>
                          <td>{{doc['status']}}</td>
                          <td>{{doc['municipality']['municipality']}}</td>
                          <td>
                              {% for owner in doc['owners'] %}
                              <a href="{{url_for('main.profile', status="owner", person=owner['name'])}}">{{owner['name']}}</a><br/>
                              {% endfor %}
                          </td>
                          <td>
                              {% for auth in doc['authorized'] %}
                              <a href="{{url_for('main.profile', status="authorized", person=auth['name'])}}">{{auth['name']}}</a><br/>
                              {% endfor %}
                          </td>
                      </tr>
                      {% endfor %}
                  {%else%}
                      <tr>
                          <td colspan="5" class="text-center">
                              Nuk u gjet ansj&euml; dokument!
                          </td>
                      </tr>
                  {%endif%}
              </tbody>
          </table>
          <div class="col-xs-12 text-center">
              <ul id="pagination-demo" class="pagination-sm"></ul>
          </div>
          </div>
        </div>
      </div>
    </section>
    <script src="{{url_for('static', filename='js/jquery.twbsPagination.js')}}"></script>
    <script type="text/javascript">
    $(document).ready( function () {
        $('#tableLength').html($('#searchTable tbody tr').length);
        $('html, body').stop().animate({
            scrollTop: ($('#searchTable').offset().top - 190)
        }, 1250, 'easeInOutExpo');
        var urlParam = parseInt(getUrlParameter('page'));
        if (isNaN(parseFloat(urlParam))) {
            urlParam = 1;
        }
        if (parseInt("{{count}}") != 0) {
            $('#pagination-demo').twbsPagination({
                startPage: urlParam,
                totalPages: Math.ceil(parseInt("{{count}}")/parseInt("{{items_per_page}}")),
                visiblePages: 7,
                first:"E para",
                prev:"Prapa",
                next:"Perpara",
                last:"E fundit",
                initiateStartPageClick: false,
                onPageClick: function (event, page) {
                    window.location.href = "?page="+page;
                }
            });
        }
    });
    function getUrlParameter(sParam) {
        var sPageURL = decodeURIComponent(window.location.search.substring(1)),
        sURLVariables = sPageURL.split('&'),
        sParameterName,
        i;

        for (i = 0; i < sURLVariables.length; i++) {
            sParameterName = sURLVariables[i].split('=');

            if (sParameterName[0] === sParam) {
                return sParameterName[1] === undefined ? true : sParameterName[1];
            }
        }
    }
</script>

{% endblock %}
